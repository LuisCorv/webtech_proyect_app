<div class="card mx-auto w-50 p-3 bg-white text-black text-center">
<h3>Report of tickets from <%= @start_end %></h3>
</div>

<div class="card mx-auto w-50 p-3 bg-white text-black text-center mt-2">
    <div class="container">
        <div class="row">
            <div class="group col-3 mx-auto text-center">
                <strong>Created Tickets: </strong>
                <%=@tickets.count %>
            </div>
            <div class="group col-3 mx-auto text-center">
                <strong>Open Tickets: </strong>
                <%=@tickets_open.count %>
            </div>

            <div class="group col-3 mx-auto text-center">
                <strong>Closed Tickets: </strong>
                <%=@tickets_closed.count %>
            </div>

            <div class="group col-3 mx-auto text-center">
                <strong>Reopen Tickets: </strong>
                <%=@tickets_reopen.count %>
            </div>
        </div>

    </div>
        
    
</div>
<div class="card mx-auto w-50 p-3 bg-white text-black text-center mt-2">
            <div class="row">
                <h4>Histogram of <%= @start_end %></h4>
                    <canvas id="histogramChart" width="400" height="300"></canvas>
            </div>
        </div>


<br>
<div class="card mx-auto w-50 p-3 bg-white text-black text-center">
<p>
    <%= link_to "Back to the Tickets Reports", user_ticket_report_path(current_user), class:"btn btn-outline-dark", style:'margin-right: 10px;' %>
</p>
</div>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
   document.addEventListener('turbo:load', () =>{
    const histogramData = <%= @tag_counts.to_json.html_safe %>;

    // Prepare data for the chart
    const labels = Object.keys(histogramData);
    const data = Object.values(histogramData);

    // Generate the bar chart
    const ctx = document.getElementById("histogramChart").getContext("2d");
    new Chart(ctx, {
      type: "bar",
      data: {
        labels: labels,
        datasets: [{
          label: "Occurrences",
          data: data,
          backgroundColor: "rgba(75, 192, 192, 0.2)",
          borderColor: "rgba(75, 192, 192, 1)",
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: true,
            title: {
              display: true,
              text: "Frequency"
            }
          },
          x: {
            title: {
              display: true,
              text: "Count"
            }
          }
        }
      }
    });
  });
</script>